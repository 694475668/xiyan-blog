{"version":3,"file":"ApiDeclaredItem.js","sourceRoot":"","sources":["../../src/items/ApiDeclaredItem.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n// See LICENSE in the project root for license information.s\r\n\r\nimport { DeclarationReference } from '@microsoft/tsdoc/lib-commonjs/beta/DeclarationReference';\r\nimport { ApiDocumentedItem, IApiDocumentedItemJson, IApiDocumentedItemOptions } from './ApiDocumentedItem';\r\nimport { Excerpt, ExcerptToken, IExcerptTokenRange, IExcerptToken } from '../mixins/Excerpt';\r\nimport { DeserializerContext } from '../model/DeserializerContext';\r\n\r\n/**\r\n * Constructor options for {@link ApiDeclaredItem}.\r\n * @public\r\n */\r\nexport interface IApiDeclaredItemOptions extends IApiDocumentedItemOptions {\r\n  excerptTokens: IExcerptToken[];\r\n}\r\n\r\nexport interface IApiDeclaredItemJson extends IApiDocumentedItemJson {\r\n  excerptTokens: IExcerptToken[];\r\n}\r\n\r\n/**\r\n * The base class for API items that have an associated source code excerpt containing a TypeScript declaration.\r\n *\r\n * @remarks\r\n *\r\n * This is part of the {@link ApiModel} hierarchy of classes, which are serializable representations of\r\n * API declarations.\r\n *\r\n * Most `ApiItem` subclasses have declarations and thus extend `ApiDeclaredItem`.  Counterexamples include\r\n * `ApiModel` and `ApiPackage`, which do not have any corresponding TypeScript source code.\r\n *\r\n * @public\r\n */\r\n// eslint-disable-next-line @typescript-eslint/naming-convention\r\nexport class ApiDeclaredItem extends ApiDocumentedItem {\r\n  private _excerptTokens: ExcerptToken[];\r\n  private _excerpt: Excerpt;\r\n\r\n  public constructor(options: IApiDeclaredItemOptions) {\r\n    super(options);\r\n\r\n    this._excerptTokens = options.excerptTokens.map((token) => {\r\n      const canonicalReference: DeclarationReference | undefined =\r\n        token.canonicalReference === undefined\r\n          ? undefined\r\n          : DeclarationReference.parse(token.canonicalReference);\r\n      return new ExcerptToken(token.kind, token.text, canonicalReference);\r\n    });\r\n    this._excerpt = new Excerpt(this.excerptTokens, { startIndex: 0, endIndex: this.excerptTokens.length });\r\n  }\r\n\r\n  /** @override */\r\n  public static onDeserializeInto(\r\n    options: Partial<IApiDeclaredItemOptions>,\r\n    context: DeserializerContext,\r\n    jsonObject: IApiDeclaredItemJson\r\n  ): void {\r\n    super.onDeserializeInto(options, context, jsonObject);\r\n\r\n    options.excerptTokens = jsonObject.excerptTokens;\r\n  }\r\n\r\n  /**\r\n   * The source code excerpt where the API item is declared.\r\n   */\r\n  public get excerpt(): Excerpt {\r\n    return this._excerpt;\r\n  }\r\n\r\n  /**\r\n   * The individual source code tokens that comprise the main excerpt.\r\n   */\r\n  public get excerptTokens(): ReadonlyArray<ExcerptToken> {\r\n    return this._excerptTokens;\r\n  }\r\n\r\n  /**\r\n   * If the API item has certain important modifier tags such as `@sealed`, `@virtual`, or `@override`,\r\n   * this prepends them as a doc comment above the excerpt.\r\n   */\r\n  public getExcerptWithModifiers(): string {\r\n    const excerpt: string = this.excerpt.text;\r\n    const modifierTags: string[] = [];\r\n\r\n    if (excerpt.length > 0) {\r\n      if (this instanceof ApiDocumentedItem) {\r\n        if (this.tsdocComment) {\r\n          if (this.tsdocComment.modifierTagSet.isSealed()) {\r\n            modifierTags.push('@sealed');\r\n          }\r\n          if (this.tsdocComment.modifierTagSet.isVirtual()) {\r\n            modifierTags.push('@virtual');\r\n          }\r\n          if (this.tsdocComment.modifierTagSet.isOverride()) {\r\n            modifierTags.push('@override');\r\n          }\r\n        }\r\n        if (modifierTags.length > 0) {\r\n          return '/** ' + modifierTags.join(' ') + ' */\\n' + excerpt;\r\n        }\r\n      }\r\n    }\r\n\r\n    return excerpt;\r\n  }\r\n\r\n  /** @override */\r\n  public serializeInto(jsonObject: Partial<IApiDeclaredItemJson>): void {\r\n    super.serializeInto(jsonObject);\r\n    jsonObject.excerptTokens = this.excerptTokens.map((x) => {\r\n      const excerptToken: IExcerptToken = { kind: x.kind, text: x.text };\r\n      if (x.canonicalReference !== undefined) {\r\n        excerptToken.canonicalReference = x.canonicalReference.toString();\r\n      }\r\n      return excerptToken;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Constructs a new {@link Excerpt} corresponding to the provided token range.\r\n   */\r\n  public buildExcerpt(tokenRange: IExcerptTokenRange): Excerpt {\r\n    return new Excerpt(this.excerptTokens, tokenRange);\r\n  }\r\n}\r\n"]}