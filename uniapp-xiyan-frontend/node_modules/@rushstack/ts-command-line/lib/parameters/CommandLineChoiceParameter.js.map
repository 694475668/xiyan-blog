{"version":3,"file":"CommandLineChoiceParameter.js","sourceRoot":"","sources":["../../src/parameters/CommandLineChoiceParameter.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n// See LICENSE in the project root for license information.\r\n\r\nimport { ICommandLineChoiceDefinition } from './CommandLineDefinition';\r\nimport { CommandLineParameter, CommandLineParameterKind } from './BaseClasses';\r\n\r\n/**\r\n * The data type returned by {@link CommandLineParameterProvider.defineChoiceParameter}.\r\n * @public\r\n */\r\nexport class CommandLineChoiceParameter extends CommandLineParameter {\r\n  /** {@inheritDoc ICommandLineChoiceDefinition.alternatives} */\r\n  public readonly alternatives: ReadonlyArray<string>;\r\n\r\n  /** {@inheritDoc ICommandLineStringDefinition.defaultValue} */\r\n  public readonly defaultValue: string | undefined;\r\n\r\n  private _value: string | undefined = undefined;\r\n\r\n  /** {@inheritDoc ICommandLineChoiceDefinition.completions} */\r\n  public readonly completions: (() => Promise<string[]>) | undefined;\r\n\r\n  /** @internal */\r\n  public constructor(definition: ICommandLineChoiceDefinition) {\r\n    super(definition);\r\n\r\n    if (definition.alternatives.length < 1) {\r\n      throw new Error(\r\n        `When defining a choice parameter, the alternatives list must contain at least one value.`\r\n      );\r\n    }\r\n    if (definition.defaultValue && definition.alternatives.indexOf(definition.defaultValue) === -1) {\r\n      throw new Error(\r\n        `The specified default value \"${definition.defaultValue}\"` +\r\n          ` is not one of the available options: ${definition.alternatives.toString()}`\r\n      );\r\n    }\r\n\r\n    this.alternatives = definition.alternatives;\r\n    this.defaultValue = definition.defaultValue;\r\n    this.validateDefaultValue(!!this.defaultValue);\r\n    this.completions = definition.completions;\r\n  }\r\n\r\n  /** {@inheritDoc CommandLineParameter.kind} */\r\n  public get kind(): CommandLineParameterKind {\r\n    return CommandLineParameterKind.Choice;\r\n  }\r\n\r\n  /**\r\n   * {@inheritDoc CommandLineParameter._setValue}\r\n   * @internal\r\n   */\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  public _setValue(data: any): void {\r\n    // abstract\r\n    if (data !== null && data !== undefined) {\r\n      if (typeof data !== 'string') {\r\n        this.reportInvalidData(data);\r\n      }\r\n      this._value = data;\r\n      return;\r\n    }\r\n\r\n    if (this.environmentVariable !== undefined) {\r\n      // Try reading the environment variable\r\n      const environmentValue: string | undefined = process.env[this.environmentVariable];\r\n      if (environmentValue !== undefined && environmentValue !== '') {\r\n        if (this.alternatives.indexOf(environmentValue) < 0) {\r\n          const choices: string = '\"' + this.alternatives.join('\", \"') + '\"';\r\n          throw new Error(\r\n            `Invalid value \"${environmentValue}\" for the environment variable` +\r\n              ` ${this.environmentVariable}.  Valid choices are: ${choices}`\r\n          );\r\n        }\r\n        this._value = environmentValue;\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (this.defaultValue !== undefined) {\r\n      this._value = this.defaultValue;\r\n      return;\r\n    }\r\n\r\n    this._value = undefined;\r\n  }\r\n\r\n  /**\r\n   * {@inheritDoc CommandLineParameter._getSupplementaryNotes}\r\n   * @internal\r\n   */\r\n  public _getSupplementaryNotes(supplementaryNotes: string[]): void {\r\n    // virtual\r\n    super._getSupplementaryNotes(supplementaryNotes);\r\n    if (this.defaultValue !== undefined) {\r\n      supplementaryNotes.push(`The default value is \"${this.defaultValue}\".`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns the argument value for a choice parameter that was parsed from the command line.\r\n   *\r\n   * @remarks\r\n   * The return value will be `undefined` if the command-line has not been parsed yet,\r\n   * or if the parameter was omitted and has no default value.\r\n   */\r\n  public get value(): string | undefined {\r\n    return this._value;\r\n  }\r\n\r\n  /** {@inheritDoc CommandLineParameter.appendToArgList} @override */\r\n  public appendToArgList(argList: string[]): void {\r\n    if (this.value !== undefined) {\r\n      argList.push(this.longName);\r\n      argList.push(this.value);\r\n    }\r\n  }\r\n}\r\n"]}